# fbpro 프로젝트

**fbpro**는 근로자의 **근무 관리**와 **스케줄링 시스템**을 위한 웹 애플리케이션입니다. 현재 개발 중이며, 사용자는 **관리자**와 **근로자**로 구분되어 각자의 역할에 맞는 권한을 가집니다. 프로젝트는 **Spring Boot**와 **Vue.js**를 사용하여 **백엔드**와 **프론트엔드**를 구현하고 있으며, **MyBatis**를 통해 **MariaDB**와 연결됩니다.

---

## 프로젝트 개요

- **근로자 스케줄 관리**: 관리자는 근로자의 근무 일정을 수정할 수 있으며, 근로자는 자신의 일정을 확인하고 수정할 수 있습니다.
- **사용자 관리**: 관리자만 사용자(근로자) 정보를 추가/수정/삭제할 수 있으며, 근로자는 자신의 정보만 조회할 수 있습니다.
- **웹 애플리케이션**: Vue.js를 사용하여 프론트엔드의 UI를 구현하고, Spring Boot로 API 서버를 구축합니다.

---

## 주요 기능 (현재 개발 중)

### 1. 사용자 관리
- **로그인** 및 **회원가입** 기능을 통해 사용자를 관리합니다.
- **관리자**는 사용자 정보를 관리하고, **근로자**는 자신의 정보만 조회할 수 있습니다.

### 2. 근무 스케줄 관리
- **관리자**는 근로자의 근무 일정을 추가, 수정, 삭제할 수 있습니다.
- **근로자**는 자신의 근무 일정을 조회하고 수정할 수 있습니다.

### 3. 역할 관리
- **관리자**는 시스템 관리 및 근로자 스케줄을 관리할 수 있는 권한을 가집니다.
- **근로자**는 자신의 스케줄만 조회하고 수정할 수 있는 권한을 가집니다.

---

## 설계된 테이블

### 1. users 테이블
- **용도**: 사용자 정보를 저장하는 테이블입니다. 각 사용자는 고유한 `user_id`를 가지며, 이름, 비밀번호, 이메일, 역할 등의 정보가 저장됩니다.
- **컬럼**:
  - `user_id`: 사용자 고유 ID (로그인 ID)
  - `full_name`: 사용자 실명
  - `password`: 암호화된 비밀번호
  - `email`: 이메일 주소
  - `role_code`: 사용자 역할 (예: ADMIN, WORKER)
  - `created_at`: 계정 생성 시간 (자동으로 기록)

---

### 2. roles 테이블
- **용도**: 사용자의 역할을 관리하는 테이블입니다. 각 역할은 특정 권한을 가집니다.
- **컬럼**:
  - `role_code`: 역할 코드 (예: ADMIN, WORKER)
  - `role_name`: 역할 이름 (예: 관리자, 근로자)

---

### 3. schedules 테이블
- **용도**: 사용자의 근무 일정을 관리하는 테이블입니다. 각 일정은 특정 날짜와 시간에 대한 정보를 포함하고 있으며, 해당 일정은 사용자의 역할에 따라 추가, 수정, 삭제가 가능합니다.
- **컬럼**:
  - `schedule_id`: 스케줄 고유 ID
  - `user_id`: 사용자의 ID 
  - `start_time`: 근무 시작 시간
  - `end_time`: 근무 종료 시간
  - `shift_type`: 근무 유형 (예: 오전, 오후)

---

### 4. tasks 테이블
- **용도**: 스케줄에 포함된 작업을 관리하는 테이블입니다. 각 근무 시간 동안 수행할 작업이 기록됩니다.
- **컬럼**:
  - `task_id`: 작업 고유 ID
  - `schedule_id`: 스케줄 ID 
  - `task_description`: 작업 내용
  - `status`: 작업 상태 (예: 완료, 미완료)

---

### 5. change_logs 테이블
- **용도**: 사용자와 관련된 모든 변경 이력을 저장하는 테이블입니다. 사용자의 정보 수정, 삭제 등 중요한 변경 사항이 이 테이블에 기록됩니다.
- **컬럼**:
  - `change_id`: 변경 이력 고유 ID
  - `user_id`: 사용자 ID 
  - `change_type`: 변경 유형 (예: 수정, 삭제)
  - `change_description`: 변경된 내용
  - `change_date`: 변경 일시

---

### 6. shift_types 테이블
- **용도**: 근무 유형(Shift Type)을 저장하는 테이블입니다. 각 근무 유형은 특정 시작 시간과 종료 시간, 그리고 설명을 포함합니다.
- **컬럼**:
  - `shift_code`: 근무 유형 코드 (예: A1, B2) - `VARCHAR(10)`
  - `start_time`: 근무 시작 시간 - `VARCHAR(5)` (예: '07:00')
  - `end_time`: 근무 종료 시간 - `VARCHAR(5)` (예: '15:00')
  - `description`: 근무 유형 설명 (예: 'Morning Shift')

---

## 기술 스택

- **Backend**: Spring Boot, MyBatis, Java
- **Frontend**: Vue.js
- **Database**: MariaDB
- **기타**: RESTful API, Maven, Git

---

## 현재 진행 상황

1. **사용자 관리 기능**:
   - 사용자 정보 등록, 조회, 수정, 삭제 기능 구현 중.
   - **관리자**는 사용자 정보를 관리하고, **근로자**는 자신의 정보만 조회할 수 있습니다.
   
2. **근무 스케줄 관리**:
   - 관리자는 근로자의 근무 일정을 관리할 수 있으며, 근로자는 자신의 근무 일정을 조회할 수 있는 기능을 추가 중.

3. **스케줄 코드 및 근무 유형 관리**:
   - **스케줄 코드** 추가 및 더미 데이터 입력 기능 구현 완료.
   - **shift_types 테이블**을 새로 추가하여 근무 유형 정보를 관리하고 있습니다.

4. **API 설계**:
   - RESTful API를 사용하여 프론트엔드와 백엔드를 연동하고 있습니다.

---

## 오류 관리 내역

### **1. Vue.js에서 데이터 바인딩 오류**
- **오류 내용**: `user_id`와 `full_name`이 **널(null)**로 들어가는 문제.
- **원인**: Vue.js에서 `v-model`로 바인딩된 변수명이 **백엔드 VO**와 일치하지 않았음. `user_id`와 `full_name`이 아닌 `userId`와 `fullName`으로 변경하여 해결.
- **조치 사항**: `v-model` 바인딩 구문을 수정하여 **프론트엔드와 백엔드 VO의 필드명**을 일치시킴.

### **2. 로그인 API 호출 오류**
- **오류 내용**: 로그인 시, **`user_id`**가 **널(null)**로 들어가는 문제.
- **원인**: `user_id`가 제대로 바인딩되지 않아서 백엔드에 전달되는 값이 없었음.
- **조치 사항**: `v-model` 바인딩에서 **변수명 일치** 문제를 수정하여 정상적으로 값이 전달되도록 처리.

### **3. 중복 호출 문제**
- **오류 내용**: 로그인 API가 중복 호출되는 문제.
- **원인**: 로그인 버튼 클릭 시, **중복으로 요청이 발생**.
- **조치 사항**: `isSubmitting` 플래그를 추가하여 **중복 요청 방지** 로직 구현.

### **4. 400 오류 발생**
- **오류 내용**: 400 Bad Request 오류가 발생한 이유는 백엔드에서 전달되는 **`user_id`와 `full_name`이 null**로 들어와서 유효성 검증을 통과하지 못했기 때문.
- **원인**: 프론트에서 값이 제대로 전달되지 않았거나, **백엔드에서 받는 데이터 구조가 일치하지 않았음**.
- **조치 사항**: `v-model`로 바인딩된 필드명이 **백엔드 VO와 일치**하도록 수정하여 값을 제대로 전달하고, **백엔드 로그를 통해 검증**한 후 정상적으로 해결됨.

### **5. CORS 오류 (크로스 도메인 문제)**
- **오류 내용**: 프론트엔드에서 API 호출 시 CORS 오류 발생.
- **조치 사항**: 백엔드에서 **`@CrossOrigin` 어노테이션**을 사용하여 CORS 설정을 추가해 해결.

### **6. SQL 오류 (잘못된 쿼리)**
- **오류 내용**: `start_time`과 `end_time`의 데이터 타입이 `TIME`으로 되어 있어서 쿼리 실행 시 오류 발생.
- **해결 방법**: `start_time`과 `end_time`의 데이터 타입을 **`VARCHAR(5)`로 수정**하여 SQL 문법 오류를 해결했습니다.
    - 기존: `start_time TIME NOT NULL, end_time TIME NOT NULL`
    - 수정 후: `start_time VARCHAR(5), end_time VARCHAR(5)`로 변경하여 문자열 형태로 시간을 처리하도록 수정했습니다.
    - **추가 오류**: SQL 구문 오류는 쿼리에서 잘못된 구문으로 발생했습니다. 이러한 오류를 해결하기 위해 적절한 값 검증을 추가하거나 NULL을 허용하도록 변경하는 방법을 적용하였습니다.

### **7. 스케쥴 코드 바인딩 문제**
- **오류 내용**: **쉬프트 코드**가 선택되어도 제출 시 값이 **`undefined`**로 나타나는 문제.
- **원인**: 프론트엔드에서 호출된 `shiftTypes` 배열에 **`shiftCode`** 대신 **`code`**라는 이름의 필드가 들어오고 있었음. 이로 인해, **`v-model`** 바인딩을 통해 선택된 값이 **`shiftCode`**에 바인딩되지 않고, **`undefined`**로 처리되었음.
- **조치 사항**: 
   - **`shiftTypes`** 배열에서 반환되는 데이터의 필드명이 **`shiftCode`**가 아닌 **`code`**로 되어 있었음을 콘솔 로그를 통해 확인.
   - 프론트엔드에서 **`shiftCode`**로 바인딩되도록 코드를 수정하여, **`shiftTypes`** 배열의 `code` 값을 **`shiftCode`**로 일치시키도록 변경.
   - **`v-model="schedule.shiftCode"`**와 **`shift.code`**를 일치시켜, 선택된 값이 **`shiftCode`**에 정상적으로 바인딩되도록 해결.



### **8. 404 오류 발생**
- **오류 내용**: API 호출 시 **404 오류**가 발생한 문제.
- **원인**: API 경로가 정확하지 않거나, 서버에서 해당 API를 찾을 수 없는 문제.
- **조치 사항**: API 경로 및 URL이 정확하게 설정되었는지 확인하고, **Spring Controller에서 경로 설정**이 올바르게 되었는지 점검.

---

## 최종 진행 사항

1. **사용자 관리 기능**
   - 사용자 정보 등록, 조회, 수정, 삭제 기능 구현 중.
   - 관리자는 사용자 정보를 관리하고, 근로자는 자신의 정보만 조회할 수 있습니다.
   
2. **근무 스케줄 관리**
   - 관리자는 근로자의 근무 일정을 관리할 수 있으며, 근로자는 자신의 근무 일정을 조회할 수 있는 기능을 추가 중.

3. **스케줄 코드 및 근무 유형 관리**
   - 사용자가 스케줄 코드를 추가할 수 있으며, 이를 DB에 저장하도록 구현.
   - **shift_types 테이블**을 새로 추가하여 근무 유형 정보를 관리하고 있습니다.

4. **API 설계**
   - RESTful API를 사용하여 프론트엔드와 백엔드를 연동하고 있습니다.
